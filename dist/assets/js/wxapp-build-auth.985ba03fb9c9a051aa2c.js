!function(e){function t(t){for(var a,p,i=t[0],u=t[1],l=t[2],c=0,d=[];c<i.length;c++)p=i[c],Object.prototype.hasOwnProperty.call(n,p)&&n[p]&&d.push(n[p][0]),n[p]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);for(s&&s(t);d.length;)d.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],a=!0,i=1;i<r.length;i++){var u=r[i];0!==n[u]&&(a=!1)}a&&(o.splice(t--,1),e=p(p.s=r[0]))}return e}var a={},n={12:0},o=[];function p(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,p),r.l=!0,r.exports}p.m=e,p.c=a,p.d=function(e,t,r){p.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},p.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p.t=function(e,t){if(1&t&&(e=p(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(p.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)p.d(r,a,function(t){return e[t]}.bind(null,a));return r},p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return p.d(t,"a",t),t},p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.p="";var i=window.webpackJsonp=window.webpackJsonp||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var s=u;o.push(["./src/pages/wxapp-build-auth/wxapp-build-auth.js",0]),r()}({"./src/pages/wxapp-build-auth/markdown.md":function(e,t){e.exports='<h1 id=微信小程序人脸识别>微信小程序人脸识别</h1> <h3 id=授权>授权</h3> <h3 id=监听摄像头并获取数据>监听摄像头并获取数据</h3> <h3 id=数据转化>数据转化</h3> <h3 id=人脸识别>人脸识别</h3> <h2 id=其他操作>其他操作</h2> <p>微信小程序通过API可以轻松的调取用户的相机进行操作。但是在程序调取摄像头的时候微信会提示用户授权操作，这个操作可以由用户自主选择。对于某些依赖硬件的需求（比如我要是实现的人脸认证功能），无法使用摄像头那么就无法提供服务。在这种情况下，我们需要提供一个检测机制，在检测到相关操作未被授权时不能使简单的提示“对不起，因为您未允许XX操作，无法提供XX功能”。在这个时候，微信不会再次弹出授权提示选择，官方是这样定义的授权有效期的：</p> <blockquote> <p>授权有效期<br/> 一旦用户明确同意或拒绝过授权，其授权关系会记录在后台，直到用户主动删除小程序。</p> </blockquote> <p>而用户需要对拒绝的授权操作再次的操作是：</p> <blockquote> <p>打开设置界面<br/> 用户可以在小程序设置界面（「右上角」 - 「关于」 - 「右上角」 - 「设置」）中控制对该小程序的授权状态。</p> </blockquote> <p>这种操作对于普通用户来说才做起来代价太高了，无异于是“爱我的请扣1，不爱我的请扣3.1415926…”。这也就意味着一个以人脸认证为核心服务的小程序一旦被拒绝的请求相机，那么他大概率无法在被用户使用了。</p> <p>不过微信都提供了相关的API，合理的运用这些API，可以引导用户轻松修改授权并使用你的小程序，这对于用户体验的提升来说是不可估量的。下面记录的就是一个完整的授权检测流程：</p> <h2 id=api>API</h2> <p><a href=https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html>授权</a></p> <p><a href=https://developers.weixin.qq.com/miniprogram/dev/api/open-api/authorize/wx.authorize.html>wx.authorize()</a></p> <p><a href=https://developers.weixin.qq.com/miniprogram/dev/api/open-api/setting/wx.getSetting.html>wx.getSetting()</a></p> <p><a href=https://developers.weixin.qq.com/miniprogram/dev/api/open-api/setting/wx.openSetting.html>wx.openSetting()</a></p> <p><a href=https://developers.weixin.qq.com/miniprogram/dev/component/camera.html>camera</a></p> <p><a href="">createCameraContext</a></p> <p><a href="">CameraContext.onCameraFrame</a></p> <p><a href="">getFileSystemManager</a></p> <p><a href="">canvasPutImageData</a></p> <p><a href="">canvasToTempFilePath</a></p> <p><a href="">Tracking.js</a></p> '},"./src/pages/wxapp-build-auth/wxapp-build-auth.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=r("./src/assets/js/initial.js"),o=(a=n)&&a.__esModule?a:{default:a},p=r("./src/assets/js/Utils.js");r("./src/components/ArticleRead.js");var i=r("./src/data.json"),u=(0,o.default)();t.default=new u({el:"#base-panel__window",name:"markdown",data:function(){return{html:r("./src/pages/wxapp-build-auth/markdown.md")}},computed:{title:function(){return(0,p.getArticleInfo)(window.location.href,i)[0]}},mounted:function(){document.body.classList.remove("loading")}})}});